
data_array = [
    "timesteps: 50	MSE: 6.60360892652534e-05	R2:0.9976076253224164\
	timesteps: 100	MSE: 0.00011072627967223525	R2:0.9959983476437628\
	timesteps: 150	MSE: 0.0005478214006870985	R2:0.9802505299448967\
	timesteps: 200	MSE: 0.0015165075892582536	R2:0.9453950524330139\
	timesteps: 250	MSE: 0.003258726792410016	R2:0.88263388723135\
	timesteps: 300	MSE: 0.005689236801117659	R2:0.7950379550457001\
	timesteps: 350	MSE: 0.00889262743294239	R2:0.6793215870857239\
	timesteps: 400	MSE: 0.0124748470261693	R2:0.5492696464061737\
	timesteps: 450	MSE: 0.015817048028111458	R2:0.42771822214126587\
	timesteps: 500	MSE: 0.018778882920742035	R2:0.31997841596603394\
",


    "timesteps: 50	MSE: 0.0001895561144920066	R2:0.9936580387875438\
	timesteps: 100	MSE: 0.0006198846967890859	R2:0.9792690295726061\
	timesteps: 150	MSE: 0.002331230090931058	R2:0.9220769479870796\
	timesteps: 200	MSE: 0.008928532712161541	R2:0.7016114890575409\
	timesteps: 250	MSE: 0.015386114828288555	R2:0.4857785701751709\
	timesteps: 300	MSE: 0.02042756788432598	R2:0.31696611642837524\
	timesteps: 350	MSE: 0.024513810873031616	R2:0.18029189109802246\
	timesteps: 400	MSE: 0.02776118926703930	R2:0.07183468341827393\
	timesteps: 450	MSE: 0.030017323791980743	R2:-0.003573298454284668\
	timesteps: 500	MSE: 0.03188214823603630	R2:-0.06596112251281738\
",
    "timesteps: 50	MSE: 0.00012638171028811485	R2:0.9957070033997297\
	timesteps: 100	MSE: 0.0006927195936441422	R2:0.9764788132160902\
	timesteps: 150	MSE: 0.0017373349983245134	R2:0.9410393238067627\
	timesteps: 200	MSE: 0.003866750281304121	R2:0.8687950074672699\
	timesteps: 250	MSE: 0.006743465084582567	R2:0.771174430847168\
	timesteps: 300	MSE: 0.010231588035821915	R2:0.652651846408844\
	timesteps: 350	MSE: 0.014312856830656528	R2:0.514074057340622\
	timesteps: 400	MSE: 0.01789672113955021	R2:0.39248502254486084\
	timesteps: 450	MSE: 0.02100924775004387	R2:0.2868441343307495\
	timesteps: 500	MSE: 0.023665327578783035	R2:0.19665098190307617\
",
    "timesteps: 50	MSE: 0.0003753337950911373	R2:0.9868740765377879\
	timesteps: 100	MSE: 0.001616482506506145	R2:0.9434948302805424\
	timesteps: 150	MSE: 0.003254377283155918	R2:0.8863072171807289\
	timesteps: 200	MSE: 0.007458964362740517	R2:0.7394741475582123\
	timesteps: 250	MSE: 0.011448845267295837	R2:0.6001129150390625\
	timesteps: 300	MSE: 0.014210643246769905	R2:0.5034322142601013\
	timesteps: 350	MSE: 0.01608196459710598	R2:0.43801021575927734\
	timesteps: 400	MSE: 0.017501752823591232	R2:0.38846951723098755\
	timesteps: 450	MSE: 0.018599484115839005	R2:0.3501148819923401\
	timesteps: 500	MSE: 0.019466543570160866	R2:0.31978046894073486\
",
    "timesteps: 50	MSE: 0.0016486732056364417	R2:0.9363266080617905\
	timesteps: 100	MSE: 0.003865244332700968	R2:0.8507857024669647\
	timesteps: 150	MSE: 0.0061433883383870125	R2:0.7629817426204681\
	timesteps: 200	MSE: 0.009233142249286175	R2:0.6438739001750946\
	timesteps: 250	MSE: 0.012949575670063496	R2:0.5006060004234314\
	timesteps: 300	MSE: 0.016401099041104317	R2:0.3673344850540161\
	timesteps: 350	MSE: 0.019215311855077744	R2:0.25880199670791626\
	timesteps: 400	MSE: 0.021507909521460533	R2:0.1704992651939392\
	timesteps: 450	MSE: 0.023326536640524864	R2:0.10037130117416382\
	timesteps: 500	MSE: 0.024727100506424904	R2:0.04627269506454468\
",
    "timesteps: 50	MSE: 0.006191642489284277	R2:0.6683483421802521\
	timesteps: 100	MSE: 0.008817735128104687	R2:0.5278892517089844\
	timesteps: 150	MSE: 0.010981837287545204	R2:0.41232770681381226\
	timesteps: 200	MSE: 0.012605632655322552	R2:0.32565075159072876\
	timesteps: 250	MSE: 0.01367360819131136	R2:0.26881325244903564\
	timesteps: 300	MSE: 0.014444500207901001	R2:0.22760707139968872\
	timesteps: 350	MSE: 0.015031176619231701	R2:0.19626349210739136\
	timesteps: 400	MSE: 0.015488123521208763	R2:0.1719374656677246\
	timesteps: 450	MSE: 0.015836026519536972	R2:0.15333020687103271\
	timesteps: 500	MSE: 0.016104217618703842	R2:0.1389092206954956\
",
    "timesteps: 50	MSE: 0.002364769112318754	R2:0.5616120100021362\
	timesteps: 100	MSE: 0.0034429491497576237	R2:0.3622574210166931\
	timesteps: 150	MSE: 0.0039822496473789215	R2:0.26305121183395386\
	timesteps: 200	MSE: 0.004321678541600704	R2:0.2006591558456421\
	timesteps: 250	MSE: 0.00454897852614522	R2:0.15918099880218506\
	timesteps: 300	MSE: 0.004715600050985813	R2:0.12869417667388916\
	timesteps: 350	MSE: 0.004838341847062111	R2:0.10613417625427246\
	timesteps: 400	MSE: 0.004930426366627216	R2:0.08920776844024658\
	timesteps: 450	MSE: 0.005006819032132626	R2:0.07507097721099854\
	timesteps: 500	MSE: 0.0050706216134130955	R2:0.06322622299194336\
"
]

index_array = ["$\\infty$dB",'50dB', '40dB', '30dB', '20dB', '10dB', '0dB']

import matplotlib.pyplot as plt
import numpy as np

LLE = 0.9056
tL = 1/LLE
dt = 0.01


def plotNoisePerformance():
    fixed_timestep = 100
    r2_scores_at_fixed_timestep = []
    max_timesteps_above_threshold = []
    threshold = 0.55

    # Create a figure with 1 row and 2 columns
    fig, axs = plt.subplots(1, 2, figsize=(15, 6))

    for i, data in enumerate(data_array):
        timesteps = []
        mse_values = []
        r2_values = []

        parts = data.strip().split('\t')
        for j in range(0, len(parts), 3):  # Step by 3 (timestep, MSE, R2)
            timestep = int(parts[j].split(': ')[1])  # Extract timesteps
            mse = float(parts[j + 1].split(': ')[1])  # Extract MSE
            r2 = float(parts[j + 2].split(':')[1])  # Extract R2

            timesteps.append(timestep)
            mse_values.append(mse)
            r2_values.append(r2)

        # Extract R2 score for the fixed timestep
        if fixed_timestep in timesteps:
            index = timesteps.index(fixed_timestep)  # Find the index of the fixed timestep
            r2_scores_at_fixed_timestep.append(r2_values[index])  # Append the corresponding R2 value

        # Find the largest timestep where R2 > threshold
        max_timestep = max([t for t, r2 in zip(timesteps, r2_values) if r2 > threshold], default=0)
        max_timesteps_above_threshold.append(max_timestep)

    # Plot R2 scores against noise levels (subplot 1)
    axs[0].plot(index_array, r2_scores_at_fixed_timestep, marker='o', linestyle='-', color='b', label=f'$R^2$ u koraku {fixed_timestep}')
    axs[0].set_xlabel('Noise Level')
    axs[0].set_ylabel('$R^2$ Score')
    # axs[0].set_title(f'$R^2$ Score vs Noise Level at Timestep {fixed_timestep}')
    axs[0].grid(True)
    axs[0].legend()

    # Plot max timesteps above threshold against noise levels (subplot 2)
    axs[1].plot(index_array, max_timesteps_above_threshold, marker='s', linestyle='-', color='g', label=f'Max vremenski korak sa $R^2 > {threshold}$')
    axs[1].set_xlabel('Noise Level')
    axs[1].set_ylabel('Max Timestep')
    # axs[1].set_title(f'Max Timestep with $R^2 > {threshold}$ vs Noise Level')
    axs[1].grid(True)
    axs[1].legend()

    # Adjust layout and save the figure
    plt.tight_layout()
    plt.savefig('r2_vs_noise_with_max_timesteps.png')
    plt.show()

if __name__ == "__main__":
    plt.figure(figsize=(10, 6))

    for i, data in enumerate(data_array):
        timesteps = []
        mse_values = []
        r2_values = []

        parts = data.strip().split('\t')
        for j in range(0, len(parts), 3):  # Step by 3 (timestep, MSE, R2)
            timestep = int(parts[j].split(': ')[1])  # Extract timesteps
            mse = float(parts[j + 1].split(': ')[1])  # Extract MSE
            r2 = float(parts[j + 2].split(':')[1])  # Extract R2

            timesteps.append(timestep)
            mse_values.append(mse)
            r2_values.append(r2)

        time = [x*dt/tL for x in timesteps]

        # plt.plot(timesteps, mse_values, marker='o', linestyle='-',label=f'MSE - {index_array[i]}')
        plt.plot(time, r2_values, marker='x', linestyle='--', label=f'{index_array[i]}')

    plt.xlabel('time [$t_L$]')
    plt.ylabel('$R^2$ Score')
    # plt.title('Performans modela ')
    plt.legend()
    plt.grid(True)
    plt.tight_layout()
    plt.savefig('model_performance.png')
    plt.show()


    plotNoisePerformance()